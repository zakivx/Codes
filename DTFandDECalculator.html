<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DTF & DE Calculator</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #f5f5f5;
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
    }

    .container {
        background: white;
        padding: 20px;
        width: 90%;
        max-width: 420px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        margin: 20px 0;
    }

    h2 {
        text-align: center;
        margin-bottom: 20px;
        font-size: 1.4rem;
    }

    label {
        font-size: 1rem;
        margin-bottom: 5px;
        display: block;
    }

    input {
        width: 100%;
        padding: 12px;
        margin-bottom: 15px;
        font-size: 1rem;
        border: 1px solid #ccc;
        border-radius: 8px;
        box-sizing: border-box;
    }

    button {
        width: 100%;
        padding: 14px;
        font-size: 1.1rem;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
    }

    button:hover {
        background: #0056b3;
    }

    #result, #resultDE {
        text-align: center;
        margin-top: 15px;
        font-size: 1.25rem;
        font-weight: bold;
    }

    /* Reference section */
    details {
        margin-top: 20px;
        background: #fafafa;
        padding: 15px;
        border-radius: 10px;
        border: 1px solid #ddd;
    }

    summary {
        font-size: 1.1rem;
        font-weight: bold;
        cursor: pointer;
    }

    .ref-block {
        margin-top: 10px;
        font-size: 0.95rem;
        line-height: 1.5;
    }

    .subtitle {
        font-weight: bold;
        margin-top: 10px;
    }
</style>
</head>
<body>

<div class="container">
    <header style="background:#007bff; color:#fff; padding:10px; text-align:center;">
  <a href="https://zakivx.github.io/Codes/medicalTools.html" 
     style="color:#fff; text-decoration:none; font-weight:bold;">
    â† Back to Medical Tools
  </a>
</header>
    <h2>DTF & Diaphragm Excursion Calculator</h2>

    <!-- DTF inputs -->
    <label for="dtpi">DTpi (mm):</label>
    <input type="number" id="dtpi" step="0.01" placeholder="Inspiratory thickness">

    <label for="dtee">DTee (mm):</label>
    <input type="number" id="dtee" step="0.01" placeholder="End-expiratory thickness">

    <button onclick="calculateDTF()">Calculate Thickness and DTF</button>
    <div id="result"></div>

    <hr>

    <!-- NEW: Diaphragm Excursion Input -->
    <label for="de">Diaphragm Excursion (cm):</label>
    <input type="number" id="de" step="0.01" placeholder="Measured DE in cm">

    <button onclick="calculateDE()">Interpret DE</button>
    <div id="resultDE"></div>

    <!-- Reference values -->
    <details>
        <summary>Reference Values & Interpretation</summary>
        <div class="ref-block">

            <!-- Normal thickness -->
            <div class="subtitle">ğŸ“˜ Normal Diaphragm Thickness (tidal, seated)</div>
            <ul>
                <li><b>Right</b> â€“ Male: 2.1 Â± 0.4 mm; Female: 1.9 Â± 0.4 mm</li>
                <li><b>Left</b> â€“ Male: 2.0 Â± 0.4 mm; Female: 1.7 Â± 0.3 mm</li>
            </ul>

            <!-- Normal DTF -->
            <div class="subtitle">ğŸ“˜ Normal DTF (tidal breathing)</div>
            <ul>
                <li><b>Right</b> â€“ Male: 32 Â± 15%; Female: 35 Â± 16%</li>
                <li><b>Left</b> â€“ Male: 30 Â± 14%; Female: 33 Â± 15%</li>
            </ul>

            <!-- DTF pathology -->
            <div class="subtitle">ğŸ“• DTF Clinical Thresholds</div>
            <ul>
                <li>DTF<sub>max</sub> < <b>20%</b> â†’ Diaphragm dysfunction</li>
                <li>DTF < <b>25â€“33%</b> â†’ Predicts weaning failure</li>
                <li>DTF < <b>20%</b> â†’ Predicts NIV failure</li>
            </ul>

            <!-- NEW: Normal DE -->
            <div class="subtitle">ğŸ“˜ Normal Diaphragm Excursion (tidal breathing)</div>
            <ul>
                <li><b>Right</b> â€“ Male: 2.0 Â± 0.5 cm; Female: 1.9 Â± 0.5 cm</li>
                <li><b>Left</b> â€“ Male: 2.2 Â± 0.6 cm; Female: 1.9 Â± 0.5 cm</li>
            </ul>

            <!-- NEW: DE pathology -->
            <div class="subtitle">ğŸ“• DE Clinical Interpretation</div>
            <ul>
                <li>DE < <b>10â€“15 mm (1.0â€“1.5 cm)</b> â†’ Diaphragm dysfunction</li>
            </ul>

        </div>
    </details>

</div>

<script>
function calculateDTF() {
    const dtpi = parseFloat(document.getElementById("dtpi").value);
    const dtee = parseFloat(document.getElementById("dtee").value);

    if (isNaN(dtpi) || isNaN(dtee) || dtee <= 0) {
        document.getElementById("result").innerText = "â— Enter valid numbers (DTee > 0)";
        return;
    }

    const dtf = ((dtpi - dtee) / dtee) * 100;
    const thick = dtpi - dtee;
    document.getElementById("result").innerText = 
      `Thickness = ${thick} mm;
      DTF = ${dtf.toFixed(2)} %`;
}

function calculateDE() {
    const de = parseFloat(document.getElementById("de").value);

    if (isNaN(de) || de < 0) {
        document.getElementById("resultDE").innerText = "â— Enter a valid DE value";
        return;
    }

    let interpretation = "";

    if (de < 1.0) {
        interpretation = "â— Severe diaphragm dysfunction";
    } else if (de < 1.5) {
        interpretation = "âš  Likely diaphragm dysfunction";
    } else {
        interpretation = "âœ… Normal diaphragm excursion";
    }

    document.getElementById("resultDE").innerText =
        `DE = ${de.toFixed(2)} cm â†’ ${interpretation}`;
}
</script>

</body>
</html>
