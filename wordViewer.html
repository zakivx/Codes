<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DOCX viewer — fixed URL</title>

  <script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>

  <style>
    :root{
      --page-width: 800px;
      --page-margin: 40px;
      --bg: #f4f6f8;
      --paper-bg: #fff;
      --text: #222;
      --muted: #666;
    }

    html,body{
      height:100%;
      margin:0;
      font-family: Inter, Roboto, system-ui, -apple-system, "Segoe UI", "Helvetica Neue", Arial;
      background: var(--bg);
      color: var(--text);
    }

    /* Toolbar with stronger contrast */
    .topbar{
      display:flex;
      gap:8px;
      align-items:center;
      justify-content:space-between;
      padding:12px 16px;
      background: #222;
      color: #fff;
      box-shadow:0 2px 4px rgba(0,0,0,0.3);
      position:sticky;
      top:0;
      z-index:20;
    }

    .controls{
      display:flex;
      gap:8px;
      align-items:center;
    }

    button{
      padding:8px 12px;
      border-radius:8px;
      border:1px solid #444;
      background:#333;
      cursor:pointer;
      font-weight:600;
      color:#fff;
    }
    button.active{
      background:linear-gradient(180deg,#0b74ff,#0764e0);
      border-color:rgba(7,100,224,0.9);
      color:white;
    }

    .main{
      padding:20px;
      display:flex;
      justify-content:center;
      align-items:flex-start;
      gap:20px;
    }

    .viewer{
      width:100%;
      max-width:1200px;
      display:flex;
      justify-content:center;
    }

    /* Web layout → white background */
    .layout-web .paper {
      width: 100%;
      max-width: var(--page-width);
      background: var(--paper-bg);
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      margin:0;
      padding:24px;
      border-radius:6px;
    }

    /* Print layout */
    .layout-print .paper {
      width: calc(var(--page-width));
      background: var(--paper-bg);
      box-shadow: 0 10px 30px rgba(0,0,0,0.12);
      margin: var(--page-margin) 0;
      padding: 48px;
      border-radius: 6px;
    }

    .paper {
      box-sizing: border-box;
      color: var(--text);
      line-height:1.55;
      font-size:16px;
    }

    .mammoth-root h1, .mammoth-root h2, .mammoth-root h3 {
      margin: 1.1rem 0 0.5rem;
      font-weight:700;
    }
    .mammoth-root p { margin: 0.6rem 0; }
    .mammoth-root img { max-width:100%; height:auto; display:block; margin:12px 0; }
    .mammoth-root table { border-collapse: collapse; width:100%; margin:12px 0; }
    .mammoth-root table td, .mammoth-root table th { border:1px solid #ddd; padding:6px 8px; }

    .status {
      color: #ccc;
      font-size:13px;
      margin-left:8px;
    }

    @media print{
      body { background: white; }
      .topbar, .controls { display:none !important; }
      .layout-print .paper { box-shadow:none; margin:0; padding:10mm; border-radius:0; }
    }

    @media (max-width:900px){
      :root { --page-width: 92vw; --page-margin: 20px; }
      .layout-print .paper { padding:20px; }
    }
  </style>
</head>
<body class="layout-web">
  <div class="topbar">
    <div style="display:flex;gap:12px;align-items:center">
      <strong>DOCX viewer</strong>
      <span class="status" id="source">Source: https://www2.hu-berlin.de/stadtlabor/wp-content/uploads/2021/12/sample3.docx</span>
    </div>

    <div class="controls">
      <div style="display:flex;gap:6px;align-items:center">
        <button id="btnWeb" class="active">Web layout</button>
        <button id="btnPrint">Print layout</button>
      </div>
      <button id="btnRefresh">Reload</button>
      <button id="btnDownload">Download</button>
    </div>
  </div>

  <main class="main">
    <div class="viewer">
      <article class="paper" id="paper">
        <div id="content" class="mammoth-root" aria-live="polite">
          <p style="color:#666">Loading document…</p>
        </div>
      </article>
    </div>
  </main>

  <script>
    const DOCX_URL = "doc/sample3.docx";
    const btnWeb = document.getElementById('btnWeb');
    const btnPrint = document.getElementById('btnPrint');
    const btnRefresh = document.getElementById('btnRefresh');
    const btnDownload = document.getElementById('btnDownload');
    const content = document.getElementById('content');
    const body = document.body;

    btnWeb.addEventListener('click', () => {
      body.classList.remove('layout-print');
      body.classList.add('layout-web');
      btnWeb.classList.add('active'); btnPrint.classList.remove('active');
    });

    btnPrint.addEventListener('click', () => {
      body.classList.remove('layout-web');
      body.classList.add('layout-print');
      btnPrint.classList.add('active'); btnWeb.classList.remove('active');
    });

    btnDownload.addEventListener('click', () => window.open(DOCX_URL, '_blank'));
    btnRefresh.addEventListener('click', () => loadAndRenderDocx());

    async function loadAndRenderDocx(){
      content.innerHTML = '<p style="color:#666">Loading document…</p>';
      try {
        const resp = await fetch(DOCX_URL);
        const arrayBuffer = await resp.arrayBuffer();
        const result = await mammoth.convertToHtml({ arrayBuffer });
        content.innerHTML = result.value || '<p>(empty)</p>';
      } catch (err) {
        content.innerHTML = `<p style="color:red">Error loading document: ${err}</p>`;
      }
    }
    loadAndRenderDocx();
  </script>
</body>
</html>
