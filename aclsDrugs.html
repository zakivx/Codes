<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ACLS Dose Calculator</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 10px;
      background: #f2f2f2;
    }

    h2 {
      text-align: center;
      margin-bottom: 15px;
    }

    label {
      display: block;
      margin-top: 12px;
      font-weight: bold;
    }

    input, select {
      padding: 10px;
      width: 100%;
      max-width: 320px;
      margin-top: 4px;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    .box {
      margin-top: 20px;
      padding: 15px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .title {
      margin-top: 14px;
      font-weight: bold;
      text-decoration: underline;
    }

    .dose {
      margin: 8px 0;
      line-height: 1.4;
    }

    @media (max-width: 480px) {
      input, select { font-size: 1.1rem; }
      .dose { font-size: 1rem; }
      .title { font-size: 1.1rem; }
    }
  </style>
</head>

<body>
    <header style="background:#007bff; color:#fff; padding:10px; text-align:center;">
    <a href="https://zakivx.github.io/Codes/medicalTools.html" 
      style="color:#fff; text-decoration:none; font-weight:bold;">
      ← Back to Medical Tools
    </a>
    </header>
<h2>ACLS Dose Calculator</h2>

<label>
  Patient Type
  <select id="type">
    <option value="adult">Adult</option>
    <option value="pediatric">Pediatric</option>
  </select>
</label>

<label>
  Weight (kg)
  <input type="number" id="weight" min="0" step="0.1" placeholder="Enter weight in kg">
</label>

<div class="box" id="output"></div>

<script>
const typeEl = document.getElementById("type");
const weightEl = document.getElementById("weight");
const outputEl = document.getElementById("output");

window.addEventListener("DOMContentLoaded", () => {
  const t = localStorage.getItem("patientType");
  const w = localStorage.getItem("patientWeight");
  if (t) typeEl.value = t;
  if (w) weightEl.value = w;
  calculate();
});

typeEl.addEventListener("change", () => {
  localStorage.setItem("patientType", typeEl.value);
  calculate();
});

weightEl.addEventListener("input", () => {
  localStorage.setItem("patientWeight", weightEl.value);
  calculate();
});

function ml(mg, mgPerMl) {
  return (mg / mgPerMl).toFixed(2);
}

function calculate() {
  const type = typeEl.value;
  const w = parseFloat(weightEl.value);
  let html = "";

  /* ================= ADULT ================= */
  if (type === "adult") {

    /* Epinephrine */
    const epiMg = 1;

    /* Amiodarone */
    const amio1 = 300;
    const amio2 = 150;

    /* Lidocaine */
    let lidoHtml = `<div class="dose">Enter weight to calculate lidocaine</div>`;
    if (w && w > 0) {
      const l1min = 1 * w;
      const l1max = 1.5 * w;
      const l2min = 0.5 * w;
      const l2max = 0.75 * w;

      lidoHtml = `
        <div class="dose">
          First dose: ${l1min.toFixed(1)}–${l1max.toFixed(1)} mg (1-1.5mg/kg)<br>
          • 100 mg/10 mL → ${ml(l1min,10)}–${ml(l1max,10)} mL<br>
          • 200 mg/10 mL → ${ml(l1min,20)}–${ml(l1max,20)} mL
        </div>
        <div class="dose">
          Second dose: ${l2min.toFixed(1)}–${l2max.toFixed(1)} mg (0.5-0.75mg/kg)<br>
          • 100 mg/10 mL → ${ml(l2min,10)}–${ml(l2max,10)} mL<br>
          • 200 mg/10 mL → ${ml(l2min,20)}–${ml(l2max,20)} mL
        </div>
      `;
    }

    html = `
      <div class="title">Defibrillation</div>
      <div class="dose">Biphasic: 120–200 J</div>
      <div class="dose">Monophasic: 360 J</div>

      <div class="title">Epinephrine</div>
      <div class="dose">1 mg IV/IO every 3–5 min</div>
      <div class="dose">• 1 mg/10 mL → 10 mL</div>
      <div class="dose">• 1 mg/5 mL → 5 mL</div>

      <div class="title">Amiodarone</div>
      <div class="dose">
        First dose: 300 mg → ${ml(amio1,50)} mL (150 mg/3 mL)
      </div>
      <div class="dose">
        Second dose: 150 mg → ${ml(amio2,50)} mL (150 mg/3 mL)
      </div>

      <div class="title">Lidocaine</div>
      ${lidoHtml}
    `;
  }

  /* ================= PEDIATRIC ================= */
  if (type === "pediatric") {
    if (!w || w <= 0) {
      outputEl.innerHTML = "<em>Please enter a valid weight</em>";
      return;
    }

    const epiMg = Math.min(0.01 * w, 1);
    const amioMg = Math.min(5 * w, 300);
    const lidoMg = 1 * w;

    html = `
      <div class="title">Defibrillation</div>
      <div class="dose">1st: ${(2*w).toFixed(1)} J</div>
      <div class="dose">2nd: ${(4*w).toFixed(1)} J</div>
      <div class="dose">≥${(4*w).toFixed(1)} J (≥4 J/kg) (max ${(Math.min(10*w,200)).toFixed(1)} J)</div>
      max 10 J/kg or adult dose

      <div class="title">Epinephrine</div>
      <div class="dose">${epiMg.toFixed(2)} mg (0.01 mg/kg) max 1mg IV/IO</div>
      <div class="dose">• 1 mg/10 mL → ${(epiMg/0.1).toFixed(2)} mL</div>
      <div class="dose">• 1 mg/5 mL → ${(epiMg/0.2).toFixed(2)} mL</div>

      <div class="title">Amiodarone</div>
      <div class="dose">
        bolus ${amioMg.toFixed(1)} mg (5mg/kg)→ ${ml(amioMg,50)} mL (150 mg/3 mL) max 300mg <br> 
        may be repeated 3 doses , max 150mg subsequent doses
      </div>

      <div class="title">Lidocaine</div>
      <div class="dose">
        ${lidoMg.toFixed(1)} mg (1mg/kg)<br> 
        • 100 mg/10 mL → ${ml(lidoMg,10)} mL<br>
        • 200 mg/10 mL → ${ml(lidoMg,20)} mL
      </div>
    `;
  }

  outputEl.innerHTML = html;
}
</script>

</body>
</html>
